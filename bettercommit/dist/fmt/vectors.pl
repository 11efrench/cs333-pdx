3150 #!/usr/bin/perl -w
3151 
3152 # Generate vectors.S, the trap/interrupt entry points.
3153 # There has to be one entry point per interrupt number
3154 # since otherwise there's no way for trap() to discover
3155 # the interrupt number.
3156 
3157 print "# generated by vectors.pl - do not edit\n";
3158 print "# handlers\n";
3159 print ".globl alltraps\n";
3160 for(my $i = 0; $i < 256; $i++){
3161     print ".globl vector$i\n";
3162     print "vector$i:\n";
3163     if(!($i == 8 || ($i >= 10 && $i <= 14) || $i == 17)){
3164         print "  pushl \$0\n";
3165     }
3166     print "  pushl \$$i\n";
3167     print "  jmp alltraps\n";
3168 }
3169 
3170 print "\n# vector table\n";
3171 print ".data\n";
3172 print ".globl vectors\n";
3173 print "vectors:\n";
3174 for(my $i = 0; $i < 256; $i++){
3175     print "  .long vector$i\n";
3176 }
3177 
3178 # sample output:
3179 #   # handlers
3180 #   .globl alltraps
3181 #   .globl vector0
3182 #   vector0:
3183 #     pushl $0
3184 #     pushl $0
3185 #     jmp alltraps
3186 #   ...
3187 #
3188 #   # vector table
3189 #   .data
3190 #   .globl vectors
3191 #   vectors:
3192 #     .long vector0
3193 #     .long vector1
3194 #     .long vector2
3195 #   ...
3196 
3197 
3198 
3199 
